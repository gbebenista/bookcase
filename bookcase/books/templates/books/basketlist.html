{% extends 'books/base.html' %}
{% block title %}Basket{% endblock %}
{% block javascript %}
$('.deletefrombasket').click(function(){
var bookid = $(this).attr('data-catid');
const csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
$.ajax({
type:"POST",
url: "{% url 'deletefrombasket'%}",
data:{
'csrfmiddlewaretoken': csrftoken,
'book_id': bookid,
},
dataType: 'json',
success: function(data){
if (data.success){
setTimeout(function(){
location.reload();
}, 100);
}
else{
alert("There is an error occurred");
}
}
});
});
{% endblock %}
{% block content %}
{% csrf_token %}
<div class="p-4 m-auto h5">
    <p class="text-center">Your basket</p>
    <table class="table shadow bg-white rounded">
        {% for object in object_list %}
        <thead>
        <tr>
            <th scope="col">Title</th>
            <th scope="col">Author</th>
            <th scope="col">Publisher</th>
            <th scope="col"></th>
        </tr>
        </thead>
        <tbody>
        <tr>
            {% for books in object.books.all %}
            <th scope="col">{{books.title}}</th>
            <th scope="col">{{books.author}}</th>
            <th scope="col">{{books.publisher}}</th>
            <th scope="col">
                <span class="btn btn-danger deletefrombasket" data-catid="{{books.id}}" data-toggle="tooltip"
                      title="Delete from basket">
                    <i class="fa fa-minus-circle"></i>
                </span>
            </th>
        </tr>
        {% empty %}
        <tr>
            <th scope="col">Empty</th>
        </tr>
        </tbody>
        {% endfor %}
    </table>
    <a href="{% url 'setloaned' %}" class="btn btn-info borrow" data-toggle="tooltip" title="Borrow book!">Borrow</a>
    {% empty %}
    <p class="text-center"> Your basket is deleted </p>
    {% endfor %}

</div>
{% endblock %}